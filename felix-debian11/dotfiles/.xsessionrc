#!/usr/bin/env bash

#########################
# Environment variables
#########################

#export JDK_HOME=""
#export JRE_HOME=""
#export ANT_HOME=""
#export MVN_HOME=""

if [[ ! -z "${JDK_HOME}" ]]; then
	export PATH=${JDK_HOME}/bin:${PATH}
fi

if [[ ! -z "${ANT_HOME}" ]]; then
	export PATH=${ANT_HOME}/bin:${PATH}
fi

if [[ ! -z "${MVN_HOME}" ]]; then
	export PATH=${MVN_HOME}/bin:${PATH}
fi

#export GPODDER_HOME=""
#export GPODDER_DOWNLOAD_DIR=""

##################################
# Force loading of libgtk3-nocsd
##################################
export LD_PRELOAD="libgtk3-nocsd.so.0${LD_PRELOAD:+:$LD_PRELOAD}"

############################
# Re-configure the screens
############################
if [[ -f "${HOME}/.screenlayout/MyScreenLayout.sh" ]]; then
	bash "${HOME}/.screenlayout/MyScreenLayout.sh"
fi

##############
# Wallpapers
##############
#bash "${HOME}/.local/share/wallpapers/set_wallpaper.sh" &
nitrogen --restore &

####################
# Bluetooth applet
####################
blueman-applet &

########################################################################################################
# Start xss-lock to lock the session for events: suspend, hibernate, lock-session, and unlock-session.
# See <https://wiki.archlinux.org/title/Power_management#xss-lock>
#
# It does not work well with dm-tool, we use i3lock instead.
########################################################################################################
#xss-lock -- betterlockscreen -l &

#################
# Hotkey daemon
#################
sxhkd &

########################################################################################
# Keyboard should be set properly in /etc/default/keyboard but could also be done here
########################################################################################
#setxkbmap -rules evdev -model evdev -layout us -variant altgr-intl &

###########
# Xmodmap
###########
if [[ -f "${HOME}/.Xmodmap" ]]; then
	xmodmap .Xmodmap
fi

##########
# Polkit
##########
/usr/lib/policykit-1-gnome/polkit-gnome-authentication-agent-1 &

#############
# clipmenud
#############
bash "${HOME}/scripts/clipmenud_run.sh" &

#################################################################################
# DPMS (Display Power Management Signaling) is controlled with the xset command
# See <https://wiki.archlinux.org/index.php/Display_Power_Management_Signaling>
#################################################################################

# Query the current settings
# xset q
#
# Disable screen saver blanking
# xset s off
#
# Change blank time to 1 hour
# xset s 3600 3600
#
# Turn off DPMS
# xset -dpms
#
# Disable DPMS and prevent screen from blanking
# xset s off -dpms
#
# Turn off screen immediately
# xset dpms force off
#
# Standy screen
# xset dpms force standy
#
# Suspend screen
# xset dpms force suspend
#

################################
# SSH agent for X applications
################################
if [[ -d "${HOME}/.ssh" ]]; then
	HOME_LINK_SSH_AUTH_SOCK="${HOME}/.ssh/ssh_auth_sock"
	if [[ ! -S "${HOME_LINK_SSH_AUTH_SOCK}" ]]; then
		eval `ssh-agent`
		ln -sf "${SSH_AUTH_SOCK}" "${HOME_LINK_SSH_AUTH_SOCK}"
	fi
	export SSH_AUTH_SOCK="${HOME_LINK_SSH_AUTH_SOCK}"
	ssh-add -l > /dev/null || ssh-add
fi
